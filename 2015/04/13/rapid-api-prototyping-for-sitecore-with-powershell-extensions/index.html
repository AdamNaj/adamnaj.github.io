<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Rapid API prototyping for Sitecore with PowerShell Extensions | Codality</title>
<meta name="description" content="[noun] - \ko-&#39;da-la-te\ - Code and Effect - solving problems with just enough amount of code - by Adam Najmanowicz">
<meta name="generator" content="Hugo 0.156.0">

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-MXK49KSC1M"></script>
      <script>
        var doNotTrack = false;
        if ( true ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-MXK49KSC1M');
        }
      </script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;700&family=Alegreya+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400&display=swap" rel="stylesheet">

      <link rel="stylesheet" href="/css/main.min.ff306ca66e7b2bc8165a0ff06764a456af31beb5f62d1d4d77ae277fa7dfde44.css" integrity="sha256-/zBspm57K8gWWg/wZ2SkVq8xvrX2LR1Nd64nf6ff3kQ=" crossorigin="anonymous">
      <link rel="stylesheet" href="/css/syntax.min.17ca6f7a68a8709ff966c5ad518e7600f33e21bd0f8a2ce6442db978acbd0805.css" integrity="sha256-F8pvemiocJ/5ZsWtUY52APM&#43;Ib0PiizmRC25eKy9CAU=" crossorigin="anonymous">

<script>
  (function(){var s=localStorage.getItem('theme-preference');var t=s==='dark'||s==='light'?s:(window.matchMedia('(prefers-color-scheme:dark)').matches?'dark':'light');document.documentElement.setAttribute('data-theme',t)})();
</script>

        <script src="/js/main.d2bd792f5993cf0b2a94a7b1393dc363aa778f0c0fb552e82235828aff7ceae7.js" integrity="sha256-0r15L1mTzwsqlKexOT3DY6p3jwwPtVLoIjWCiv986uc=" crossorigin="anonymous"></script>



</head>
<body>
  <div class="site-wrapper">
    <header class="site-header">
      <div class="header-inner">
  <div class="header-top">
    <nav class="site-navigation" aria-label="Main Navigation">
      
  <nav>
    <ul>
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a href="/about/">About me</a>
    </li>
    <li>
      <a href="/downloads/">Downloads</a>
    </li>
    </ul>
  </nav>

    </nav>
    
    <nav class="social-navigation" aria-label="Social Links">
      <ul>
        <li><a href="https://github.com/AdamNaj" title="GitHub"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/></svg></a></li>
        <li><a href="https://www.linkedin.com/in/najmanowicz/" title="LinkedIn"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg></a></li>
        <li><a href="http://www.twitter.com/AdamNaj" title="Twitter"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg></a></li>
        <li><a href="https://www.facebook.com/adam.najmanowicz" title="Facebook"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg></a></li>
        <li><a href="https://www.instagram.com/adamnajmanowicz/" title="Instagram"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg></a></li>
      </ul>
    </nav>
    
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">
      <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
      <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
    </button>
  </div>
  <div class="site-branding">
    <p class="site-title"><a href="/">Codality</a></p>
    
    <p class="site-tagline">[noun] - \ko-&#39;da-la-te\ - Code and Effect - solving problems with just enough amount of code - by Adam Najmanowicz</p>
    
    <hr class="header-separator"><nav class="tag-cloud" aria-label="Category Cloud"><a href="/categories/best-practices/" style="font-size: 14px;" title="best practices (14 posts)">Best Practices</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/blog-navigator/" style="font-size: 12px;" title="blog navigator (8 posts)">Blog Navigator</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/cms/" style="font-size: 24px;" title="cms (79 posts)">CMS</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/cms-ux/" style="font-size: 12px;" title="cms ux (8 posts)">CMS UX</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/code-samples/" style="font-size: 16px;" title="code samples (35 posts)">Code Samples</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/continuous-deployment/" style="font-size: 11px;" title="continuous deployment (4 posts)">Continuous Deployment</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/desktop-customization/" style="font-size: 11px;" title="desktop customization (4 posts)">Desktop Customization</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/downloadable/" style="font-size: 14px;" title="downloadable (22 posts)">Downloadable</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/epicode/" style="font-size: 14px;" title="epicode (16 posts)">EPiCode</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/episerver/" style="font-size: 18px;" title="episerver (41 posts)">EPiServer</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/faceted-navigation/" style="font-size: 11px;" title="faceted navigation (5 posts)">Faceted Navigation</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/icondeveloper/" style="font-size: 11px;" title="icondeveloper (3 posts)">IconDeveloper</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/internet-information-services/" style="font-size: 12px;" title="internet information services (11 posts)">Internet Information Services</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/lifestyle/" style="font-size: 14px;" title="lifestyle (13 posts)">Lifestyle</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/microsoft-sqlserver/" style="font-size: 12px;" title="microsoft sqlserver (6 posts)">Microsoft SqlServer</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/mobile/" style="font-size: 11px;" title="mobile (4 posts)">Mobile</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/open-source/" style="font-size: 16px;" title="open source (24 posts)">Open Source</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/powershell/" style="font-size: 18px;" title="powershell (43 posts)">PowerShell</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/rants/" style="font-size: 12px;" title="rants (7 posts)">Rants</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/scripting/" style="font-size: 18px;" title="scripting (43 posts)">Scripting</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/security/" style="font-size: 11px;" title="security (2 posts)">Security</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/sitecore/" style="font-size: 18px;" title="sitecore (38 posts)">Sitecore</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/skinning/" style="font-size: 12px;" title="skinning (10 posts)">Skinning</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/skinstudio/" style="font-size: 14px;" title="skinstudio (13 posts)">SkinStudio</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/software-development/" style="font-size: 28px;" title="software development (99 posts)">Software Development</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/solution/" style="font-size: 18px;" title="solution (42 posts)">Solution</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/stardock/" style="font-size: 16px;" title="stardock (25 posts)">Stardock</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/tooling/" style="font-size: 14px;" title="tooling (13 posts)">Tooling</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/visual-studio/" style="font-size: 12px;" title="visual studio (7 posts)">Visual Studio</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/webparts/" style="font-size: 11px;" title="webparts (2 posts)">WebParts</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/windowblinds/" style="font-size: 12px;" title="windowblinds (12 posts)">WindowBlinds</a></nav>
    <hr class="tag-cloud-separator"></div>
</div>

    </header>
    <div class="site-main">
      <aside class="sidebar">
  <div class="widget">
    <h2 class="widget-title">Search</h2>
    <form class="search-form" action="/search/" method="get">
      <input type="search" class="search-field" placeholder="Search ..." name="q">
    </form>
  </div>

  
  <div class="widget widget-mvp">
    <a href="https://mvp.sitecore.com/en/Directory/Profile?id=e416ef1dabf5468ff4fa08dd30f068bb" title="Sitecore Technology MVP 2026">
      <img src="/images/sitecore-mvp-2026-technology.png" alt="Sitecore Technology MVP 2026" class="mvp-badge" width="250">
    </a>
    
    <div class="mvp-badges-history">
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2017-Technology.png" alt="MVP Badge 2017" class="mvp-badge-small">
        <span class="mvp-badge-year">2017</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2016-Technology.png" alt="MVP Badge 2016" class="mvp-badge-small">
        <span class="mvp-badge-year">2016</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2015-Technology.png" alt="MVP Badge 2015" class="mvp-badge-small">
        <span class="mvp-badge-year">2015</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2014-Technology.png" alt="MVP Badge 2014" class="mvp-badge-small">
        <span class="mvp-badge-year">2014</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2013-Technology.png" alt="MVP Badge 2013" class="mvp-badge-small">
        <span class="mvp-badge-year">2013</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2012-Technology.png" alt="MVP Badge 2012" class="mvp-badge-small">
        <span class="mvp-badge-year">2012</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2011-Technology.png" alt="MVP Badge 2011" class="mvp-badge-small">
        <span class="mvp-badge-year">2011</span>
      </div>
      
    </div>
    
  </div>
  

  
</aside>

      <main class="content-area">
        
  <article class="post single">
    <div class="content-area">
      <header class="entry-header">
        <h1 class="entry-title">Rapid API prototyping for Sitecore with PowerShell Extensions</h1>
        <div class="entry-meta">
          <time datetime="2015-04-13T13:04:15&#43;00:00">
            April 13, 2015
          </time>
          
          <span class="author">by Adam Najmanowicz</span>
          
          <span class="reading-time">
            <svg class="reading-time-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            7 min read
          </span>
        </div>
        
        <div class="entry-categories">
          
          <a href="https://blog.najmanowicz.com/categories/cms/" class="category-badge">CMS</a>
          
          <a href="https://blog.najmanowicz.com/categories/powershell/" class="category-badge">PowerShell</a>
          
          <a href="https://blog.najmanowicz.com/categories/scripting/" class="category-badge">Scripting</a>
          
          <a href="https://blog.najmanowicz.com/categories/sitecore/" class="category-badge">Sitecore</a>
          
          <a href="https://blog.najmanowicz.com/categories/software-development/" class="category-badge">Software Development</a>
          
          <a href="https://blog.najmanowicz.com/categories/solution/" class="category-badge">Solution</a>
          
        </div>
        
      </header>

      <div class="entry-content">
        <p><a href="/images/short_cut_400_clr_7608.png"><img src="/images/short_cut_400_clr_7608_thumb.png" alt="short_cut_400_clr_7608" title="short_cut_400_clr_7608" class="alignleft" width="400" height="210" /></a></p>
<p>This post describes how you can deliver JSON/XML/HTML APIs quickly with Sitecore PowerShell Extensions.
Technically this was also available earlier but the API was not refined to the state it is now.
As Sitecore is constantly progressing from predominantly serving as a  CMS towards becoming a mobile and web application delivery platform (which is very apparent by the recent increase of SPEAK popularity, the introduction of Item Web API and the app centric nature of the new Sitecore 8 interface there is an increased need to rapidly deliver APIs for those those front end applications to work seamlessly with the CMS back-end.
PowerShell Extensions can help you with that move by enabling rapid prototyping of APIs that are either JSON or XML in nature.</p>
<h2 id="how-to-make-scripts-available-for-the-web-api">How to make scripts available for the Web API?</h2>
<p><a href="https://github.com/SitecorePowerShell/Console/issues/118">This functionality</a> is available in Sitecore PowerShell Extensions starting from version 2.5, however I was never happy with how it worked and how the URLs were structured. With the <a href="/2014/11/01/sitecore-powershell-extensions-3-0-modules-proposal/" title="Sitecore PowerShell Extensions 3.0 Modules proposal">Modules functionality</a> introduced in 2.8 it was a good time to model it properly for SPE 3.0.
To make a script callable through the v2 of the API you need to place it in an Enabled module in the <code>Web API</code> integration point library.</p>
<p><a href="/images/ScriptPlacement1.png"><img src="/images/ScriptPlacement1-300x293.png" alt="" class="aligncenter" width="300" height="293" /></a></p>
<p>SPE will automatically make all the scripts available under this folder executable from its Web API service. If you don&rsquo;t have the library in your module you can simply create a new Library named <code>Web API</code> or run the <em><strong>Create libraries for integration points</strong></em> wizard by right clicking the module in the Content Editor.</p>
<p><a href="/images/IntPointCreation1.png"><img src="/images/IntPointCreation1-300x293.png" alt="IntPointCreation1" class="aligncenter" width="300" height="293" /></a></p>
<p>And executing the wizard as follows:</p>
<p><a href="/images/IntPointCreation2.png"><img src="/images/IntPointCreation2-244x300.png" alt="IntPointCreation2" class="aligncenter" width="244" height="300" /></a></p>
<h2 id="how-to-call-the-exposed-scripts">How to call the exposed scripts?</h2>
<p>The syntax of the URL looks as follows:</p>
<p><a href="/images/API.png"><img src="/images/API-1024x179.png" alt="API" class="aligncenter" width="1024" height="179" /></a></p>
<h3 id="authorization-authentication-and-anonymous-users">Authorization, authentication and anonymous users</h3>
<p>If you&rsquo;re already working as a logged in user there is n need to provide credentials and you can work with all databases that are available to your user group, however if you&rsquo;re not authorized you can place 2 additional parameters: <code>user</code> and <code>password</code> to provide the missing credentials. So the above URL can look as follows: <code>http://hostname/-/script/v2/master/ChildrenAsJson?item=content&amp;user=admin&amp;password=b</code> which will result in a request authenticated as the standard Sitecore <strong>admin</strong>.
If you need to call the Web API script as an unauthenticated user - that&rsquo;s also fine however the <code>database</code> switch will not work (which is an intentional behaviour) and <strong>only the scripts that are published to your target database</strong> will work. The API will prevent the switch and automatically default to the public database. In this case you need to make sure that the module in the <strong>enabled</strong> state as well as your scripts are published to the target database.
<strong>Caution!</strong> If you&rsquo;re using a version of the SPE module previous to 3.1 and want to run scripts from a database different than the context database e.g. <code>master</code> you need to provide additional parameter <code>scriptDb=master</code> to the parameters list. This is due to a bug in the URL rewriting I&rsquo;m doing and is fixed in version 3.1 of the module. Credits for <a href="https://github.com/SitecorePowerShell/Console/issues/329">finding this and reporting</a> goes to a colleague of mine from Cognifide - Andrzej Pucilowski!</p>
<h3 id="how-script-names-are-resolved">How script names are resolved?</h3>
<p>The script name provided in the URL will be resolved among all the enabled modules&rsquo; <code>Web API</code> libraries. The script name is relative to the <code>Web API</code> library. This allows you to switch between versions of your API versions easily by having 2 modules with the same script names and enable one module while disabling the other to switch between versions.</p>
<h3 id="what-are-the-variables-in-the-url-and-how-do-i-use-them">What are the variables in the URL and how do I use them?</h3>
<p>All variables that are provided in the URL will be passed to your script as PowerShell variables, so the <code>item</code> parameter specified above will be available to your script as a PowerShell <code>$item</code> variable. To avoid name collisions or malicious attempts at modifying the script behaviour by overriding system variables any parameter that is already defined as a PS variable prior to script execution in the environment will be skipped. so you cannot override e.g. <code>$HOME</code> or <code>$true</code>.</p>
<h3 id="error-detection">Error detection</h3>
<p>Should your script encounter any execution errors the API will respond with the HTTP Code <code>424 Method Failure</code> and should produce the error information as well as the script output.</p>
<h2 id="writing-scripts-to-respond-to-api-calls">Writing Scripts to respond to API calls</h2>
<p>The API call will respond with whatever your script produces as an output in text form. By default the response will be of MIME type <code>text/plain</code> but you can modify it easily as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$HttpContext</span> <span class="o">-ne</span> <span class="vm">$null</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$HttpContext</span><span class="p">.</span><span class="py">Response</span><span class="p">.</span><span class="py">ContentType</span> <span class="p">=</span> <span class="s2">&#34;application/json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>You also need to make sure your response is in the proper format depending on the response, but PowerShell is of great help here providing us with the support of conversion in form of <code>ConvertTo-Json</code>, <code>ConvertTo-Xml</code>, <code>ConvertTo-Html</code> or even <code>ConvertTo-Csv</code> cmdlets.</p>
<h2 id="what-can-i-do-with-it">What can I do with it?</h2>
<p>Armed in the knowledge we can start writing APIs let&rsquo;s start with a JSON API that will return a basic list of children of a given item:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">#if the location is not Sitecore tree, switch to root of Master Database</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">((</span><span class="nb">Get-Location</span><span class="p">).</span><span class="py">Provider</span><span class="p">.</span><span class="py">Name</span> <span class="o">-ne</span> <span class="s2">&#34;CmsItemProvider&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-Location</span> <span class="n">master</span><span class="err">:</span><span class="p">\</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#change the path to the item that was given as an item parameter</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd </span><span class="nv">$item</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#Set the response MIME type to JSON</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$HttpContext</span> <span class="o">-ne</span> <span class="vm">$null</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$HttpContext</span><span class="p">.</span><span class="py">Response</span><span class="p">.</span><span class="py">ContentType</span> <span class="p">=</span> <span class="s2">&#34;application/json&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#if JSON serialization depth is not provided as a parameter set it to 1</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$depth</span> <span class="o">-eq</span> <span class="vm">$null</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$depth</span> <span class="p">=</span> <span class="mf">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#return some of the children&#39;s properties as JSON</span>
</span></span><span class="line"><span class="cl"><span class="nb">gci </span><span class="p">.</span> <span class="p">|</span> <span class="nb">select-object</span> <span class="vm">@</span><span class="p">{</span><span class="n">Label</span><span class="p">=</span><span class="s2">&#34;Path&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span> <span class="nv">$_</span><span class="p">.</span><span class="py">Paths</span><span class="p">.</span><span class="n">Path</span><span class="p">}}</span>  <span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">DisplayName</span><span class="p">,</span> <span class="n">TemplateName</span><span class="p">,</span> <span class="n">Language</span><span class="p">,</span> <span class="n">Version</span><span class="p">,</span> <span class="n">Paths</span> <span class="p">|</span> <span class="nb">ConvertTo-Html</span> <span class="n">-Depth</span> <span class="nv">$depth</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now when we save the script with a <code>ChildrenAsJson</code> name to a <code>Web API</code> library in our module, we can call it as follows:
<code>http://hostname/-/script/v2/master/ChildrenAsJson?item=content&amp;user=admin&amp;password=b</code>
Which will produce the following result:</p>
<p><a href="/images/ApiCall1.png"><img src="/images/ApiCall1.png" alt="ApiCall1" class="aligncenter" width="752" height="1059" /></a></p>
<p> 
You might have noticed that I&rsquo;ve neglected to provide the <code>depth</code> parameter which resulted in using <code>1</code> as the default, but if I specify it as <code>2</code> the URL and the output will change to:</p>
<p><a href="/images/ApiCall2.png"><img src="/images/ApiCall2.png" alt="ApiCall2" class="aligncenter" width="752" height="1059" /></a></p>
<p> 
Nice, isn&rsquo;t it?
Similarly if I need my API to be in the XML format a matching script could look as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="k">if</span><span class="p">((</span><span class="nb">Get-Location</span><span class="p">).</span><span class="py">Provider</span><span class="p">.</span><span class="py">Name</span> <span class="o">-ne</span> <span class="s2">&#34;CmsItemProvider&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Set-Location</span> <span class="n">master</span><span class="err">:</span><span class="p">\</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd </span><span class="nv">$item</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$HttpContext</span> <span class="o">-ne</span> <span class="vm">$null</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$HttpContext</span><span class="p">.</span><span class="py">Response</span><span class="p">.</span><span class="py">ContentType</span> <span class="p">=</span> <span class="s2">&#34;text/xml&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c">#return some of the children&#39;s properties as XML</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="nb">gci </span><span class="p">.</span> <span class="p">|</span> <span class="nb">select-object</span> <span class="n">Name</span><span class="p">,</span> <span class="n">DiaplayName</span><span class="p">,</span> <span class="n">TemplateName</span><span class="p">,</span> <span class="n">Language</span><span class="p">,</span> <span class="n">Version</span><span class="p">,</span> <span class="n">Paths</span> <span class="p">|</span> <span class="nb">ConvertTo-Xml</span><span class="p">).</span><span class="py">OuterXml</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Which would produce the following output:</p>
<p><a href="/images/ApiCall3.png"><img src="/images/ApiCall3.png" alt="ApiCall3" class="aligncenter" width="772" height="898" /></a></p>
<p>Naturally your XML might need further work but this simple example gives you the idea on how you can approach it. As for a human readable version of the report you could do it as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">#Let&#39;s style it nicely:</span>
</span></span><span class="line"><span class="cl"><span class="nv">$head</span> <span class="p">=</span> <span class="s1">&#39;&lt;style&gt;&#39;</span><span class="p">+</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;body{font-family:&#34;Lucida Sans Unicode&#34;, &#34;Lucida Grande&#34;, Sans-Serif; text-align:left;}&#39;</span><span class="p">+</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;h1 {width:100%;font-family: &#34;Skolar Bold&#34;, Palatino, Cambria, &#34;Droid Serif&#34;, Georgia, &#34;Times New Roman&#34;, Times, serif; font-size: 28px;}&#39;</span><span class="p">+</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;p {width:100%;font-family: &#34;Proxima Nova Regular&#34;, &#34;Helvetica Neue&#34;, Calibri, &#34;Droid Sans&#34;, Helvetica, Arial, sans-serif; font-size: 18px}&#39;</span><span class="p">+</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;table {font-size:12px; border-collapse:collapse; border:1px solid #69c; margin:20px;}&#39;</span><span class="p">+</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;th{font-weight:normal; font-size:14px; color:#039; border-bottom:1px dashed #69c; padding:12px 17px;}&#39;</span><span class="p">+</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;td{color:#668;padding:7px 17px;border-bottom: 1px dashed #d8e8ff;}&#39;</span><span class="p">+</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;tbody tr:hover td{color:#339;background:#f0f0ff;}&#39;</span><span class="p">+</span>
</span></span><span class="line"><span class="cl"> <span class="s1">&#39;&lt;/style&gt;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c">#and provide a title so users know what they are looking at </span>
</span></span><span class="line"><span class="cl"><span class="nv">$body</span> <span class="p">=</span> <span class="s2">&#34;&lt;h1&gt;Children of </span><span class="p">$(</span><span class="nv">$item</span><span class="p">)</span><span class="s2">&lt;/h1&gt;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">((</span><span class="nb">Get-Location</span><span class="p">).</span><span class="py">Provider</span><span class="p">.</span><span class="py">Name</span> <span class="o">-ne</span> <span class="s2">&#34;CmsItemProvider&#34;</span><span class="p">){</span>
</span></span><span class="line"><span class="cl"> <span class="nb">Set-Location</span> <span class="n">master</span><span class="err">:</span><span class="p">\</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd </span><span class="nv">$item</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#let the browser know they are looking at an HTML output</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$HttpContext</span> <span class="o">-ne</span> <span class="vm">$null</span><span class="p">){</span>
</span></span><span class="line"><span class="cl"> <span class="nv">$HttpContext</span><span class="p">.</span><span class="py">Response</span><span class="p">.</span><span class="py">ContentType</span> <span class="p">=</span> <span class="s2">&#34;text/html&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c"># now query and format the output</span>
</span></span><span class="line"><span class="cl"><span class="nb">gci </span><span class="p">.</span> <span class="p">|</span> <span class="nb">select-object</span> <span class="n">Name</span><span class="p">,</span> <span class="n">DisplayName</span><span class="p">,</span> <span class="n">TemplateName</span><span class="p">,</span> <span class="n">Language</span><span class="p">,</span> <span class="n">Version</span><span class="p">,</span> <span class="n">ProviderPath</span> <span class="p">|</span> <span class="nb">ConvertTo-Html</span> <span class="n">-head</span> <span class="nv">$head</span> <span class="n">-body</span> <span class="nv">$body</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="p">[</span><span class="no">System.Web.HttpUtility</span><span class="p">]::</span><span class="n">HtmlDecode</span><span class="p">(</span><span class="nv">$_</span><span class="p">)</span> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Showing to the users as:</p>
<p><a href="/images/ApiCall4.png"><img src="/images/ApiCall4.png" alt="ApiCall4" class="aligncenter" width="801" height="447" /></a></p>
<p>So you can easily create scripted reports available under a simple URL to the unauthenticated users if needed.</p>
<h2 id="what-else">What else?</h2>
<p>The scripts I&rsquo;ve shown focus on providing output to your external applications, but since those are just regular PowerShell scripts you can easily include actions that will modify your content as part of the execution. Naturally this is a double edged sword and you should test those properly as they are a sharp tool to expose externally. personally I use SPE to create rapid prototypes and iterate over my API usability improvements and further down the development process potentially replace those with C# implementations, not to introduce a hard dependency on SPE, but e.g. in case of reports SPE implementation is good enough and gives me flexibility that is hard to give up even in production scenarios.
Should you at some point decide that this API is not desirable on your production servers you can easily disable it as described in <a href="https://github.com/SitecorePowerShell/Console/issues/289">this issue on our GitHub repository</a>.</p>

      </div>

      <footer class="entry-footer">
        

        <nav class="post-navigation">
          
          <div class="nav-previous">
            <a href="/2015/04/07/using-sitecore-content-search-in-powershell-extensions/">&laquo; Using Sitecore Content Search in PowerShell Extensions</a>
          </div>
          
          
          <div class="nav-next">
            <a href="/2015/05/05/turn-your-sitecore-powershell-reports-into-applications-with-action-scripts/">Turn your Sitecore PowerShell reports into applications with Action Scripts &raquo;</a>
          </div>
          
        </nav>
      </footer>

      
<div class="comments">
  <h2 class="comments-title">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "https://blog.najmanowicz.com/2015/04/13/rapid-api-prototyping-for-sitecore-with-powershell-extensions/";
      this.page.identifier = "/2015/04/13/rapid-api-prototyping-for-sitecore-with-powershell-extensions/";
      this.page.identifier = '3677796294';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://codality.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

    </div>
  </article>

      </main>
    </div>
    <footer class="site-footer">
      <div class="footer-inner">
  <p>&copy; 1999-2026 - <a href="/">Adam Najmanowicz</a></p>
  
</div>

    </footer>
  </div>
  <button class="back-to-top" id="back-to-top" aria-label="Back to top" title="Back to top">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"/></svg>
  </button>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.highlight').forEach(function(block) {
      block.style.position = 'relative';
      var btn = document.createElement('button');
      btn.className = 'copy-btn';
      btn.setAttribute('aria-label', 'Copy code');
      btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>';
      block.appendChild(btn);
      btn.addEventListener('click', function() {
        var code = block.querySelector('td:last-child code') || block.querySelector('code');
        if (code) {
          navigator.clipboard.writeText(code.textContent).then(function() {
            btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>';
            setTimeout(function() {
              btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>';
            }, 2000);
          });
        }
      });
    });
  });
  </script>
  <script>
  (function() {
    var btn = document.getElementById('back-to-top');
    if (!btn) return;
    var visible = false;
    window.addEventListener('scroll', function() {
      var shouldShow = window.scrollY > 400;
      if (shouldShow !== visible) {
        visible = shouldShow;
        btn.classList.toggle('visible', visible);
      }
    }, { passive: true });
    btn.addEventListener('click', function() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  })();
  </script>
  <div class="lightbox-overlay" id="lightbox">
    <button class="lightbox-close" id="lightbox-close" aria-label="Close lightbox">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
    <div class="lightbox-content" id="lightbox-content"></div>
  </div>
  <script>
  (function() {
    var overlay = document.getElementById('lightbox');
    var content = document.getElementById('lightbox-content');
    var closeBtn = document.getElementById('lightbox-close');
    var imgExts = /\.(jpe?g|png|gif|webp|svg|bmp|avif)(\?.*)?$/i;
    var vidExts = /\.(mp4|webm|ogg)(\?.*)?$/i;

    function open(href) {
      content.innerHTML = '';
      if (imgExts.test(href)) {
        var img = document.createElement('img');
        img.src = href;
        img.alt = '';
        content.appendChild(img);
      } else if (vidExts.test(href)) {
        var vid = document.createElement('video');
        vid.src = href;
        vid.controls = true;
        vid.autoplay = true;
        content.appendChild(vid);
      } else {
        return false;
      }
      overlay.classList.add('active');
      document.body.style.overflow = 'hidden';
      return true;
    }

    function close() {
      overlay.classList.remove('active');
      document.body.style.overflow = '';
      var vid = content.querySelector('video');
      if (vid) vid.pause();
    }

    document.addEventListener('click', function(e) {
      var link = e.target.closest('a[href]');
      if (!link) return;
      var href = link.getAttribute('href');
      if (imgExts.test(href) || vidExts.test(href)) {
        e.preventDefault();
        open(href);
      }
    });

    closeBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      close();
    });

    overlay.addEventListener('click', function(e) {
      if (e.target === overlay) close();
    });

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && overlay.classList.contains('active')) close();
    });
  })();
  </script>
  <script id="dsq-count-scr" src="https://codality.disqus.com/count.js" async></script>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    var mermaidBlocks = document.querySelectorAll('pre > code.language-mermaid');
    if (mermaidBlocks.length > 0) {
      var s = document.createElement('script');
      s.src = 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js';
      s.onload = function() {
        var mermaidTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default';
        mermaid.initialize({ startOnLoad: false, theme: mermaidTheme });
        mermaidBlocks.forEach(function(block) {
          var pre = block.parentElement;
          var div = document.createElement('div');
          div.className = 'mermaid';
          div.textContent = block.textContent;
          pre.parentNode.replaceChild(div, pre);
        });
        mermaid.run();
      };
      document.head.appendChild(s);
    }
  });
  </script>
</body>
</html>
