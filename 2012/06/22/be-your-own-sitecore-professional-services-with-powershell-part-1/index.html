<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Be your own Sitecore Professional Services with PowerShell (Part 1) | Codality</title>
<meta name="description" content="[noun] - \ko-&#39;da-la-te\ - Code and Effect - solving problems with just enough amount of code - by Adam Najmanowicz">
<meta name="generator" content="Hugo 0.156.0">

      <script async src="https://www.googletagmanager.com/gtag/js?id=G-MXK49KSC1M"></script>
      <script>
        var doNotTrack = false;
        if ( true ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-MXK49KSC1M');
        }
      </script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;700&family=Alegreya+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400&display=swap" rel="stylesheet">

      <link rel="stylesheet" href="/css/main.min.ff306ca66e7b2bc8165a0ff06764a456af31beb5f62d1d4d77ae277fa7dfde44.css" integrity="sha256-/zBspm57K8gWWg/wZ2SkVq8xvrX2LR1Nd64nf6ff3kQ=" crossorigin="anonymous">
      <link rel="stylesheet" href="/css/syntax.min.17ca6f7a68a8709ff966c5ad518e7600f33e21bd0f8a2ce6442db978acbd0805.css" integrity="sha256-F8pvemiocJ/5ZsWtUY52APM&#43;Ib0PiizmRC25eKy9CAU=" crossorigin="anonymous">

<script>
  (function(){var s=localStorage.getItem('theme-preference');var t=s==='dark'||s==='light'?s:(window.matchMedia('(prefers-color-scheme:dark)').matches?'dark':'light');document.documentElement.setAttribute('data-theme',t)})();
</script>

        <script src="/js/main.d2bd792f5993cf0b2a94a7b1393dc363aa778f0c0fb552e82235828aff7ceae7.js" integrity="sha256-0r15L1mTzwsqlKexOT3DY6p3jwwPtVLoIjWCiv986uc=" crossorigin="anonymous"></script>



</head>
<body>
  <div class="site-wrapper">
    <header class="site-header">
      <div class="header-inner">
  <div class="header-top">
    <nav class="site-navigation" aria-label="Main Navigation">
      
  <nav>
    <ul>
    <li>
      <a href="/">Home</a>
    </li>
    <li>
      <a href="/about/">About me</a>
    </li>
    <li>
      <a href="/downloads/">Downloads</a>
    </li>
    </ul>
  </nav>

    </nav>
    
    <nav class="social-navigation" aria-label="Social Links">
      <ul>
        <li><a href="https://github.com/AdamNaj" title="GitHub"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z"/></svg></a></li>
        <li><a href="https://www.linkedin.com/in/najmanowicz/" title="LinkedIn"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"/></svg></a></li>
        <li><a href="http://www.twitter.com/AdamNaj" title="Twitter"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg></a></li>
        <li><a href="https://www.facebook.com/adam.najmanowicz" title="Facebook"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg></a></li>
        <li><a href="https://www.instagram.com/adamnajmanowicz/" title="Instagram"><svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"/></svg></a></li>
      </ul>
    </nav>
    
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">
      <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
      <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
    </button>
  </div>
  <div class="site-branding">
    <p class="site-title"><a href="/">Codality</a></p>
    
    <p class="site-tagline">[noun] - \ko-&#39;da-la-te\ - Code and Effect - solving problems with just enough amount of code - by Adam Najmanowicz</p>
    
    <hr class="header-separator"><nav class="tag-cloud" aria-label="Category Cloud"><a href="/categories/best-practices/" style="font-size: 14px;" title="best practices (14 posts)">Best Practices</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/blog-navigator/" style="font-size: 12px;" title="blog navigator (8 posts)">Blog Navigator</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/cms/" style="font-size: 24px;" title="cms (79 posts)">CMS</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/cms-ux/" style="font-size: 12px;" title="cms ux (8 posts)">CMS UX</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/code-samples/" style="font-size: 16px;" title="code samples (35 posts)">Code Samples</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/continuous-deployment/" style="font-size: 11px;" title="continuous deployment (4 posts)">Continuous Deployment</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/desktop-customization/" style="font-size: 11px;" title="desktop customization (4 posts)">Desktop Customization</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/downloadable/" style="font-size: 14px;" title="downloadable (22 posts)">Downloadable</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/epicode/" style="font-size: 14px;" title="epicode (16 posts)">EPiCode</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/episerver/" style="font-size: 18px;" title="episerver (41 posts)">EPiServer</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/faceted-navigation/" style="font-size: 11px;" title="faceted navigation (5 posts)">Faceted Navigation</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/icondeveloper/" style="font-size: 11px;" title="icondeveloper (3 posts)">IconDeveloper</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/internet-information-services/" style="font-size: 12px;" title="internet information services (11 posts)">Internet Information Services</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/lifestyle/" style="font-size: 14px;" title="lifestyle (13 posts)">Lifestyle</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/microsoft-sqlserver/" style="font-size: 12px;" title="microsoft sqlserver (6 posts)">Microsoft SqlServer</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/mobile/" style="font-size: 11px;" title="mobile (4 posts)">Mobile</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/open-source/" style="font-size: 16px;" title="open source (24 posts)">Open Source</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/powershell/" style="font-size: 18px;" title="powershell (43 posts)">PowerShell</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/rants/" style="font-size: 12px;" title="rants (7 posts)">Rants</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/scripting/" style="font-size: 18px;" title="scripting (43 posts)">Scripting</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/security/" style="font-size: 11px;" title="security (2 posts)">Security</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/sitecore/" style="font-size: 18px;" title="sitecore (38 posts)">Sitecore</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/skinning/" style="font-size: 12px;" title="skinning (10 posts)">Skinning</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/skinstudio/" style="font-size: 14px;" title="skinstudio (13 posts)">SkinStudio</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/software-development/" style="font-size: 28px;" title="software development (99 posts)">Software Development</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/solution/" style="font-size: 18px;" title="solution (42 posts)">Solution</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/stardock/" style="font-size: 16px;" title="stardock (25 posts)">Stardock</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/tooling/" style="font-size: 14px;" title="tooling (13 posts)">Tooling</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/visual-studio/" style="font-size: 12px;" title="visual studio (7 posts)">Visual Studio</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/webparts/" style="font-size: 11px;" title="webparts (2 posts)">WebParts</a><span class="tag-cloud-sep" aria-hidden="true">&middot;</span><a href="/categories/windowblinds/" style="font-size: 12px;" title="windowblinds (12 posts)">WindowBlinds</a></nav>
    <hr class="tag-cloud-separator"></div>
</div>

    </header>
    <div class="site-main">
      <aside class="sidebar">
  <div class="widget">
    <h2 class="widget-title">Search</h2>
    <form class="search-form" action="/search/" method="get">
      <input type="search" class="search-field" placeholder="Search ..." name="q">
    </form>
  </div>

  
  <div class="widget widget-mvp">
    <a href="https://mvp.sitecore.com/en/Directory/Profile?id=e416ef1dabf5468ff4fa08dd30f068bb" title="Sitecore Technology MVP 2026">
      <img src="/images/sitecore-mvp-2026-technology.png" alt="Sitecore Technology MVP 2026" class="mvp-badge" width="250">
    </a>
    
    <div class="mvp-badges-history">
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2017-Technology.png" alt="MVP Badge 2017" class="mvp-badge-small">
        <span class="mvp-badge-year">2017</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2016-Technology.png" alt="MVP Badge 2016" class="mvp-badge-small">
        <span class="mvp-badge-year">2016</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2015-Technology.png" alt="MVP Badge 2015" class="mvp-badge-small">
        <span class="mvp-badge-year">2015</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2014-Technology.png" alt="MVP Badge 2014" class="mvp-badge-small">
        <span class="mvp-badge-year">2014</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2013-Technology.png" alt="MVP Badge 2013" class="mvp-badge-small">
        <span class="mvp-badge-year">2013</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2012-Technology.png" alt="MVP Badge 2012" class="mvp-badge-small">
        <span class="mvp-badge-year">2012</span>
      </div>
      
      
      
      <div class="mvp-badge-item">
        <img src="/images/mvp/2011-Technology.png" alt="MVP Badge 2011" class="mvp-badge-small">
        <span class="mvp-badge-year">2011</span>
      </div>
      
    </div>
    
  </div>
  

  
</aside>

      <main class="content-area">
        
  <article class="post single">
    <div class="content-area">
      <header class="entry-header">
        <h1 class="entry-title">Be your own Sitecore Professional Services with PowerShell (Part 1)</h1>
        <div class="entry-meta">
          <time datetime="2012-06-22T15:13:32&#43;00:00">
            June 22, 2012
          </time>
          
          <span class="author">by Adam Najmanowicz</span>
          
          <span class="reading-time">
            <svg class="reading-time-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            7 min read
          </span>
        </div>
        
        <div class="entry-categories">
          
          <a href="https://blog.najmanowicz.com/categories/best-practices/" class="category-badge">Best Practices</a>
          
          <a href="https://blog.najmanowicz.com/categories/cms/" class="category-badge">CMS</a>
          
          <a href="https://blog.najmanowicz.com/categories/cms-ux/" class="category-badge">CMS UX</a>
          
          <a href="https://blog.najmanowicz.com/categories/code-samples/" class="category-badge">Code Samples</a>
          
          <a href="https://blog.najmanowicz.com/categories/open-source/" class="category-badge">Open Source</a>
          
          <a href="https://blog.najmanowicz.com/categories/powershell/" class="category-badge">PowerShell</a>
          
          <a href="https://blog.najmanowicz.com/categories/scripting/" class="category-badge">Scripting</a>
          
          <a href="https://blog.najmanowicz.com/categories/sitecore/" class="category-badge">Sitecore</a>
          
          <a href="https://blog.najmanowicz.com/categories/software-development/" class="category-badge">Software Development</a>
          
          <a href="https://blog.najmanowicz.com/categories/solution/" class="category-badge">Solution</a>
          
        </div>
        
      </header>

      <div class="entry-content">
        <p><a href="/images/PS_detective1.png"><img src="/images/PS_detective_thumb1.png" alt="PS_detective" title="PS_detective" class="alignleft" width="201" height="240" /></a></p>
<p>Recently I&rsquo;ve been asked to audit a site for one of our clients. Overall for a fairly seasoned Sitecore developer it&rsquo;s rather obvious what to look for in a site and get a feel for whether an a solution is thoroughly thought through or just put together using brute-force development. You can usually tell if the implementation is sloppy or excellent, but how do you quantify that feeling to give the objective view to the person reading your report? Looking at the Sitecore Developer Network I&rsquo;ve found the following <a href="http://sdn.sitecore.net/reference/sitecore%206/recommended%20practices.aspx">set of recommendations</a>. This is a great help with codifying how a proper Sitecore implementation should look like, what should we pay attention to and most importantly it&rsquo;s a great reference when you&rsquo;re trying to prove that your feeling is something more than just nitpicking but rather an industry standard that the developers should adhere to. I recommend strongly that you look at it and think how closely your practices match those that Sitecore recommends.</p>
<p>There is a small problem though. Not all of them are easy to asses, at least not without some clever tools in your toolbox. for example what do I do with a statement like:</p>
<blockquote>
<p><em>Use TreelistEx instead of Treelist when showing very big trees &ndash; like the Home node and its descendants &ndash; or have lots of Treelist fields in one single item. TreelistEx only computes the tree when you click Edit whereas a Treelist will compute it every time it is rendered.</em></p>
</blockquote>
<p>It might be fine in a small site to verify in a few data templates that it&rsquo;s not violated, butÂ  In my case I was dealing with a multisite platform that can potentially host tens or even hundreds of sites? Going manually over the hundreds of fields in nearly 300 data templates, bah even finding them &ndash; would not be fun or easy thing to do. But hey? we have PowerShell why should I look there if I can whip up a one liner for it? Let&rsquo;s try it then.</p>
<p>In any of the following scripts it is important to navigate to the appropriate part of the Sitecore tree? which in my case could be:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">cd </span><span class="n">master</span><span class="err">:</span><span class="p">\</span><span class="n">templates</span><span class="p">\</span><span class="n">Cognifide</span><span class="p">\</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>or</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">cd </span><span class="n">master</span><span class="err">:</span><span class="p">\</span><span class="n">content</span><span class="p">\</span><span class="n">Home</span><span class="p">\</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>in the case of the recommendation above you could use the following one liner within the templates branch to list what field types and in what numbers you have in your solution:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">get-childitem</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">where-object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">TemplateName</span> <span class="o">-eq</span> <span class="s2">&#34;Template Field&#34;</span> <span class="p">}</span> <span class="p">|</span>  <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">group-object</span> <span class="nb">Type </span><span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">sort </span><span class="n">count</span> <span class="n">-descending</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>To get some idea what kind of fields and in what quantities you&rsquo;ve used in your solution, then probably you need to identify all those pesky Treelist fields:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">get-childitem</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">where-object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">TemplateName</span> <span class="o">-eq</span> <span class="s2">&#34;Template Field&#34;</span> <span class="o">-and</span> <span class="nv">$_</span><span class="p">.</span><span class="nb">Type </span><span class="o">-eq</span> <span class="s2">&#34;Treelist&#34;</span> <span class="p">}</span> <span class="p">|</span>  <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">format-table</span> <span class="n">ItemPath</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So that you can easily investigate them. In my case the result of the script looks as follows:</p>
<p><a href="/images/TreeListResults.png"><img src="/images/TreeListResults_thumb.png" alt="TreeListResults" title="TreeListResults" class="aligncenter" width="644" height="256" /></a></p>
<p>I think you will agree it&rsquo;s faster than hunting for it all over the tree, right?</p>
<p>In many cases or if you&rsquo;re just writing an audit - you might be more interested in numbers rather than actual lists of items. in those cases it&rsquo;s probably easiest to replace the last <strong>format-xxx</strong> element in the pipeline with <strong>measure</strong>. This way you don&rsquo;t have to count the lines</p>
<img src="/images/wlEmoticon-winkingsmile.png" alt="Puszczam oczko" class="aligncenter" />
<p>Now what other recommendations PowerShell helped me with?</p>
<h3 id="make-good-use-of-inheritance">Make good use of inheritance</h3>
<blockquote>
<p><strong>Make good use of inheritance</strong> ? Place commonly used sections and fields in their own template, so that more specific templates can inherit them. For example, the <strong>Title</strong> and <strong>Text</strong> fields in the <strong>Page Title</strong> and <strong>Text</strong> section are used in multiple different content templates. Rather than duplicate these fields in each content template, simply inherit the <strong>Page Title</strong> and <strong>Text</strong> template.</p>
</blockquote>
<p>What does this mean? Basically every data template that inherits from the <strong>Standard template</strong> is a candidate to violate this. So you might want to investigate the items that you will have listed as a result of the following script:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">get-childitem</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">where-object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">TemplateName</span> <span class="o">-eq</span> <span class="s2">&#34;Template&#34;</span> <span class="o">-and</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">                 <span class="nv">$_</span><span class="p">.</span><span class="s2">&#34;__base template&#34;</span> <span class="o">-match</span> <span class="s2">&#34;1930BBEB&#34;</span> <span class="p">}</span> <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">   <span class="nb">format-table</span> <span class="n">ItemPath</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>what it does is: check all the templates that have the first segment of the GUID signature in it&rsquo;s base template for a match with Standard Template. Now the output you get does not list the items that violate the rule, it just lists all your base types, what you need to verify is that this list makes sense and that perhaps some of the templates might be moved up the inheritance structure.</p>
<h3 id="assign-icons-to-templates">Assign icons to templates</h3>
<blockquote>
<p><strong>Assign icons to templates</strong> ? This provides a visual clue to the type of item that will be created.</p>
</blockquote>
<p>this one will be similar. You want to learn which templates do not define <strong>__Icon</strong> here:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">get-childitem</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">where-object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">TemplateName</span> <span class="o">-eq</span> <span class="s2">&#34;Template&#34;</span> <span class="o">-and</span> <span class="nv">$_</span><span class="p">.</span><span class="s2">&#34;__icon&#34;</span> <span class="o">-eq</span> <span class="s2">&#34;&#34;</span> <span class="p">}</span> <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">format-table</span> <span class="n">ItemPath</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>You might need to be careful with using <strong>measure</strong> here. Since templates will also contain rendering templates and Rendering templates have no use for icons, so you need to subtract those from your audit figure.</p>
<h3 id="__standard-values">__Standard Values</h3>
<blockquote>
<p><strong>__Standard Values</strong> ? Define layout details, initial workflow, and insert options to a template. This reduces administration and centrally manages system settings, rather than setting them on individual items</p>
</blockquote>
<p><a href="http://adeneys.wordpress.com/author/adeneys/">Alistair Deneys</a> have blogged about <a href="http://adeneys.wordpress.com/2009/04/24/find-items-which-override-standard-values-using-revolver/">how to do something like this in Revolver</a>, You might want to read his blog before proceeding. I will try to replicate some of that in PowerShell.</p>
<p>Simplest approach would be to find the templates that <strong>do not have Standard Values</strong> and perform an assessment on whether you need rendering or workflow attached to them:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">get-childitem</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">where-object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">TemplateName</span> <span class="o">-eq</span> <span class="s2">&#34;Template&#34;</span> <span class="o">-and</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">                <span class="p">!</span><span class="nv">$_</span><span class="p">.</span><span class="n">Children</span><span class="p">[</span><span class="s2">&#34;__Standard Values&#34;</span><span class="p">]</span> <span class="p">}</span> <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">  <span class="nb">format-table</span> <span class="n">ItemPath</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once you have the list, go over it and rationalize whether the item does or does not need Standard Values and thus Renderings/Workflows/Insert Options attached to them.</p>
<p>Now let&rsquo;s look at the items <strong>with Standard Values</strong> defined. With the following script you might want to find out which of templates that define the Renderings,Default Workflows, Insert Options or Rules.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">get-childitem</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">  <span class="nb">where-object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">TemplateName</span> <span class="o">-eq</span> <span class="s2">&#34;Template&#34;</span> <span class="o">-and</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Children</span><span class="p">[</span><span class="s2">&#34;__Standard Values&#34;</span><span class="p">]}</span> <span class="p">|</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">  <span class="nb">select-object</span> <span class="n">ItemPath</span><span class="p">,</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;__StandardValues&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">Children</span><span class="p">[</span><span class="s2">&#34;__Standard Values&#34;</span><span class="p">]}}</span> <span class="p">|</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">  <span class="nb">format-table</span> <span class="n">ItemPath</span><span class="p">,</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;Has Renderings&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={!</span><span class="nv">$_</span><span class="p">.</span><span class="n">__StandardValues</span><span class="p">[</span><span class="s2">&#34;__Renderings&#34;</span><span class="p">]}},</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;Default Workflow&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">__StandardValues</span><span class="p">[</span><span class="s2">&#34;__Default Workflow&#34;</span><span class="p">]}},</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;Insert Options&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">__StandardValues</span><span class="p">[</span><span class="s2">&#34;__masters&#34;</span><span class="p">]}},</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;Insert Rules&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">__StandardValues</span><span class="p">[</span><span class="s2">&#34;__Insert Rules&#34;</span><span class="p">]}}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Having that data on the screen might be limiting &ndash; if you want to export it and then process it in Excel you might do so with a small change modifying the script above to look like following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">get-childitem</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">  <span class="nb">where-object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="py">TemplateName</span> <span class="o">-eq</span> <span class="s2">&#34;Template&#34;</span> <span class="o">-and</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Children</span><span class="p">[</span><span class="s2">&#34;__Standard Values&#34;</span><span class="p">]}</span> <span class="p">|</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">  <span class="nb">select-object</span> <span class="n">ItemPath</span><span class="p">,</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;__StandardValues&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">Children</span><span class="p">[</span><span class="s2">&#34;__Standard Values&#34;</span><span class="p">]}}</span> <span class="p">|</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">  <span class="nb">select-object</span> <span class="n">ItemPath</span><span class="p">,</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;Has Renderings&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={!</span><span class="nv">$_</span><span class="p">.</span><span class="n">__StandardValues</span><span class="p">[</span><span class="s2">&#34;__Renderings&#34;</span><span class="p">]}},</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;Default Workflow&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">__StandardValues</span><span class="p">[</span><span class="s2">&#34;__Default Workflow&#34;</span><span class="p">]}},</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;Insert Options&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">__StandardValues</span><span class="p">[</span><span class="s2">&#34;__masters&#34;</span><span class="p">]}},</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">    <span class="vm">@</span><span class="p">{</span><span class="n">Name</span><span class="p">=</span><span class="s2">&#34;Insert Rules&#34;</span><span class="p">;</span> <span class="n">Expression</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">__StandardValues</span><span class="p">[</span><span class="s2">&#34;__Insert Rules&#34;</span><span class="p">]}}</span>  <span class="p">|</span> <span class="p">`</span>
</span></span><span class="line"><span class="cl">        <span class="nb">export-csv</span> <span class="n">C:</span><span class="p">\</span><span class="n">temp</span><span class="p">\</span><span class="n">StandardValues</span><span class="p">.</span><span class="py">csv</span> <span class="n">-NoTypeInformation</span> <span class="n">-Delimiter</span> <span class="p">`</span><span class="n">t</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then import the file to Excel using the following:</p>
<p><a href="/images/ExcelImport1.png"><img src="/images/ExcelImport_thumb1.png" alt="ExcelImport" title="ExcelImport" class="aligncenter" width="412" height="250" /></a></p>
<p>So you can graph and agonize about the values to your heart?s content.</p>
<p>Now what about items that use those templates? After all the recommendation states:</p>
<blockquote>
<p>This [?] centrally manages system settings, rather than setting them on individual items.</p>
</blockquote>
<p>Cool, let&rsquo;s find the items that violate this recommendation. The following finds all items that define renderings or insert options/rules of their own (set-location to your content part of the tree before running it):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">get-childitem</span> <span class="n">-recurse</span> <span class="p">|</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">  <span class="nb">where-object</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="py">__Renderings</span> <span class="o">-or</span> <span class="nv">$_</span><span class="p">.</span><span class="py">__masters</span> <span class="o">-or</span> <span class="nv">$_</span><span class="p">.</span><span class="s2">&#34;__Insert Rules&#34;</span> <span class="p">}</span> <span class="p">|</span> <span class="p">`</span>   
</span></span><span class="line"><span class="cl">  <span class="nb">format-table</span> <span class="n">ItemPath</span><span class="p">,</span> <span class="n">__Renderings</span><span class="p">,</span> <span class="n">__masters</span><span class="p">,</span> <span class="s2">&#34;__Insert Rules&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now the fact that something is there does not by itself means the recommendation is being violated. The option is there to use it, just use it sparingly and where it makes sense, it&rsquo;s only when you&rsquo;ll build your layout over and over again you risk your Sitecore consultant start crying when they visit you.</p>
<p>I&rsquo;ll go over more recommendations regarding fields usage and how to audit them in the next post.</p>

      </div>

      <footer class="entry-footer">
        

        <nav class="post-navigation">
          
          <div class="nav-previous">
            <a href="/2012/04/06/using-powershell-console-for-sitecore-in-your-own-code/">&laquo; Using PowerShell Console for Sitecore in your own code</a>
          </div>
          
          
          <div class="nav-next">
            <a href="/2013/01/29/sitecore-powershell-console-in-visual-studio/">Sitecore PowerShell Console in Visual Studio &raquo;</a>
          </div>
          
        </nav>
      </footer>

      
<div class="comments">
  <h2 class="comments-title">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "https://blog.najmanowicz.com/2012/06/22/be-your-own-sitecore-professional-services-with-powershell-part-1/";
      this.page.identifier = "/2012/06/22/be-your-own-sitecore-professional-services-with-powershell-part-1/";
      this.page.identifier = '739866578';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://codality.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

    </div>
  </article>

      </main>
    </div>
    <footer class="site-footer">
      <div class="footer-inner">
  <p>&copy; 1999-2026 - <a href="/">Adam Najmanowicz</a></p>
  
</div>

    </footer>
  </div>
  <button class="back-to-top" id="back-to-top" aria-label="Back to top" title="Back to top">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"/></svg>
  </button>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.highlight').forEach(function(block) {
      block.style.position = 'relative';
      var btn = document.createElement('button');
      btn.className = 'copy-btn';
      btn.setAttribute('aria-label', 'Copy code');
      btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>';
      block.appendChild(btn);
      btn.addEventListener('click', function() {
        var code = block.querySelector('td:last-child code') || block.querySelector('code');
        if (code) {
          navigator.clipboard.writeText(code.textContent).then(function() {
            btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>';
            setTimeout(function() {
              btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>';
            }, 2000);
          });
        }
      });
    });
  });
  </script>
  <script>
  (function() {
    var btn = document.getElementById('back-to-top');
    if (!btn) return;
    var visible = false;
    window.addEventListener('scroll', function() {
      var shouldShow = window.scrollY > 400;
      if (shouldShow !== visible) {
        visible = shouldShow;
        btn.classList.toggle('visible', visible);
      }
    }, { passive: true });
    btn.addEventListener('click', function() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  })();
  </script>
  <div class="lightbox-overlay" id="lightbox">
    <button class="lightbox-close" id="lightbox-close" aria-label="Close lightbox">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
    </button>
    <div class="lightbox-content" id="lightbox-content"></div>
  </div>
  <script>
  (function() {
    var overlay = document.getElementById('lightbox');
    var content = document.getElementById('lightbox-content');
    var closeBtn = document.getElementById('lightbox-close');
    var imgExts = /\.(jpe?g|png|gif|webp|svg|bmp|avif)(\?.*)?$/i;
    var vidExts = /\.(mp4|webm|ogg)(\?.*)?$/i;

    function open(href) {
      content.innerHTML = '';
      if (imgExts.test(href)) {
        var img = document.createElement('img');
        img.src = href;
        img.alt = '';
        content.appendChild(img);
      } else if (vidExts.test(href)) {
        var vid = document.createElement('video');
        vid.src = href;
        vid.controls = true;
        vid.autoplay = true;
        content.appendChild(vid);
      } else {
        return false;
      }
      overlay.classList.add('active');
      document.body.style.overflow = 'hidden';
      return true;
    }

    function close() {
      overlay.classList.remove('active');
      document.body.style.overflow = '';
      var vid = content.querySelector('video');
      if (vid) vid.pause();
    }

    document.addEventListener('click', function(e) {
      var link = e.target.closest('a[href]');
      if (!link) return;
      var href = link.getAttribute('href');
      if (imgExts.test(href) || vidExts.test(href)) {
        e.preventDefault();
        open(href);
      }
    });

    closeBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      close();
    });

    overlay.addEventListener('click', function(e) {
      if (e.target === overlay) close();
    });

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && overlay.classList.contains('active')) close();
    });
  })();
  </script>
  <script id="dsq-count-scr" src="https://codality.disqus.com/count.js" async></script>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    var mermaidBlocks = document.querySelectorAll('pre > code.language-mermaid');
    if (mermaidBlocks.length > 0) {
      var s = document.createElement('script');
      s.src = 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js';
      s.onload = function() {
        var mermaidTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default';
        mermaid.initialize({ startOnLoad: false, theme: mermaidTheme });
        mermaidBlocks.forEach(function(block) {
          var pre = block.parentElement;
          var div = document.createElement('div');
          div.className = 'mermaid';
          div.textContent = block.textContent;
          pre.parentNode.replaceChild(div, pre);
        });
        mermaid.run();
      };
      document.head.appendChild(s);
    }
  });
  </script>
</body>
</html>
